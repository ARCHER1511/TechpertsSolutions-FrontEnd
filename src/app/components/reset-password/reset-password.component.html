<h2>Reset Password</h2>

<form [formGroup]="resetForm" (ngSubmit)="submit()">
  <div>
    <input
      type="password"
      formControlName="newPassword"
      placeholder="New Password"
    />
    <div *ngIf="resetForm.get('newPassword')?.touched && resetForm.get('newPassword')?.invalid" style="color:red">
      <div *ngIf="resetForm.get('newPassword')?.hasError('required')">Password is required</div>
      <div *ngIf="resetForm.get('newPassword')?.hasError('minlength')">Password must be at least 6 characters</div>
      <div *ngIf="resetForm.get('newPassword')?.hasError('pattern')">
        Must include uppercase, lowercase, and a number
      </div>
    </div>
  </div>

  <div style="margin-top:10px;">
    <input
      type="password"
      formControlName="confirmPassword"
      placeholder="Confirm Password"
    />
    <div *ngIf="resetForm.get('confirmPassword')?.touched" style="color:red">
      <div *ngIf="resetForm.get('confirmPassword')?.hasError('required')">Confirm password is required</div>
      <!-- group-level mismatch message shown when both fields filled and not equal -->
      <div *ngIf="resetForm.hasError('mismatch')">Passwords don't match</div>
    </div>
  </div>

  <button type="submit" [disabled]="resetForm.invalid || !token" style="margin-top:15px;">
    Reset Password
  </button>
</form>

<div *ngIf="message" style="color:green; margin-top:10px;">{{ message }}</div>
<div *ngIf="error" style="color:red; margin-top:10px;">{{ error }}</div>